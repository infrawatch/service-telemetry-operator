- name: Lookup template
  debug:
    msg: "{{ lookup('template', './manifest_snmp_traps.j2') | from_yaml }}"

- name: Set default snmp traps manifest
  set_fact:
    snmp_traps_manifest_deploy: "{{ lookup('template', './manifest_snmp_traps.j2') | from_yaml }}"
  when: snmp_traps_manifest is not defined

- name: Create an instance of snmp webhook
  k8s:
    definition:
      '{{ snmp_traps_manifest }}'
